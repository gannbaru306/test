<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>JSON → MIDI 最小テスト</title>
  <script src="https://cdn.jsdelivr.net/npm/midi-writer-js@2.1.1"></script>
</head>
<body>

<button id="btn">MIDI作成</button>

<script>
document.getElementById("btn").onclick = () => {
  try {
    if (typeof MidiWriter === "undefined") {
      alert("MidiWriter が読み込まれていません");
      return;
    }

    const track = new MidiWriter.Track();
    track.setTempo(120);

    track.addEvent(
      new MidiWriter.NoteEvent({
        pitch: ['C4'],
        duration: '4'
      })
    );

    const write = new MidiWriter.Writer([track]);
    const blob = new Blob([write.buildFile()], { type: "audio/midi" });

    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "test.mid";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

  } catch (e) {
    alert(e.message);
  }
};
</script>

</body>
</html>
